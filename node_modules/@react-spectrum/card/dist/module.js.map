{"mappings":"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","sources":["packages/@react-spectrum/card/src/index.ts","packages/@react-spectrum/card/src/CardView.tsx","packages/@react-spectrum/card/src/CardBase.tsx","packages/@adobe/spectrum-css-temp/components/card/vars.css","packages/@react-spectrum/card/src/CardViewContext.tsx","packages/@react-spectrum/card/src/*.js","packages/@react-spectrum/card/intl/ar-AE.json","packages/@react-spectrum/card/intl/bg-BG.json","packages/@react-spectrum/card/intl/cs-CZ.json","packages/@react-spectrum/card/intl/da-DK.json","packages/@react-spectrum/card/intl/de-DE.json","packages/@react-spectrum/card/intl/el-GR.json","packages/@react-spectrum/card/intl/en-US.json","packages/@react-spectrum/card/intl/es-ES.json","packages/@react-spectrum/card/intl/et-EE.json","packages/@react-spectrum/card/intl/fi-FI.json","packages/@react-spectrum/card/intl/fr-FR.json","packages/@react-spectrum/card/intl/he-IL.json","packages/@react-spectrum/card/intl/hr-HR.json","packages/@react-spectrum/card/intl/hu-HU.json","packages/@react-spectrum/card/intl/it-IT.json","packages/@react-spectrum/card/intl/ja-JP.json","packages/@react-spectrum/card/intl/ko-KR.json","packages/@react-spectrum/card/intl/lt-LT.json","packages/@react-spectrum/card/intl/lv-LV.json","packages/@react-spectrum/card/intl/nb-NO.json","packages/@react-spectrum/card/intl/nl-NL.json","packages/@react-spectrum/card/intl/pl-PL.json","packages/@react-spectrum/card/intl/pt-BR.json","packages/@react-spectrum/card/intl/pt-PT.json","packages/@react-spectrum/card/intl/ro-RO.json","packages/@react-spectrum/card/intl/ru-RU.json","packages/@react-spectrum/card/intl/sk-SK.json","packages/@react-spectrum/card/intl/sl-SI.json","packages/@react-spectrum/card/intl/sr-SP.json","packages/@react-spectrum/card/intl/sv-SE.json","packages/@react-spectrum/card/intl/tr-TR.json","packages/@react-spectrum/card/intl/uk-UA.json","packages/@react-spectrum/card/intl/zh-CN.json","packages/@react-spectrum/card/intl/zh-TW.json","packages/@react-spectrum/card/src/GalleryLayout.tsx","packages/@react-spectrum/card/src/BaseLayout.tsx","packages/@react-spectrum/card/src/GridLayout.tsx","packages/@react-spectrum/card/src/WaterfallLayout.tsx","packages/@react-spectrum/card/src/Card.tsx"],"sourcesContent":["/*\n * Copyright 2021 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\n/// <reference types=\"css-module-types\" />\n\nexport type {GalleryLayoutOptions} from './GalleryLayout';\nexport type {GridLayoutOptions} from './GridLayout';\nexport type {WaterfallLayoutOptions} from './WaterfallLayout';\n\nexport {CardView} from './CardView';\nexport {GalleryLayout} from './GalleryLayout';\nexport {GridLayout} from './GridLayout';\nexport {WaterfallLayout} from './WaterfallLayout';\nexport {Card} from './Card';\nexport type {SpectrumCardViewProps} from '@react-types/card';\n","/*\n * Copyright 2021 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {CardBase} from './CardBase';\nimport {CardViewContext, useCardViewContext} from './CardViewContext';\nimport {classNames, useDOMRef, useStyleProps, useUnwrapDOMRef} from '@react-spectrum/utils';\nimport {DOMRef, DOMRefValue, Node} from '@react-types/shared';\nimport {GridCollection, useGridState} from '@react-stately/grid';\n// @ts-ignore\nimport intlMessages from '../intl/*.json';\nimport {mergeProps} from '@react-aria/utils';\nimport {ProgressCircle} from '@react-spectrum/progress';\nimport React, {ReactElement, ReactNode, useCallback, useMemo, useRef} from 'react';\nimport {ReusableView} from '@react-stately/virtualizer';\nimport {SpectrumCardViewProps} from '@react-types/card';\nimport styles from '@adobe/spectrum-css-temp/components/card/vars.css';\nimport {useCollator, useLocale, useLocalizedStringFormatter} from '@react-aria/i18n';\nimport {useGrid, useGridCell, useGridRow} from '@react-aria/grid';\nimport {useListState} from '@react-stately/list';\nimport {useProvider} from '@react-spectrum/provider';\nimport {Virtualizer, VirtualizerItem} from '@react-aria/virtualizer';\n\nfunction CardView<T extends object>(props: SpectrumCardViewProps<T>, ref: DOMRef<HTMLDivElement>) {\n  let {scale} = useProvider();\n  let {styleProps} = useStyleProps(props);\n  let domRef = useDOMRef(ref);\n  let {\n    isQuiet,\n    renderEmptyState,\n    layout,\n    loadingState,\n    onLoadMore,\n    cardOrientation = 'vertical'\n  } = props;\n\n  let collator = useCollator({usage: 'search', sensitivity: 'base'});\n  let isLoading = loadingState === 'loading' || loadingState === 'loadingMore';\n  let cardViewLayout = useMemo(() => typeof layout === 'function' ? new layout({collator, cardOrientation, scale}) : layout, [layout, collator, cardOrientation, scale]);\n  let layoutType = cardViewLayout.layoutType;\n\n  let stringFormatter = useLocalizedStringFormatter(intlMessages);\n  let {direction} = useLocale();\n  let {collection} = useListState(props);\n\n  let gridCollection = useMemo(() => new GridCollection<T>({\n    columnCount: 1,\n    items: [...collection].map(item => ({\n      // Makes the Grid row use the keys the user provides to the cards so that selection change via interactions returns the card keys\n      ...item,\n      hasChildNodes: true,\n      childNodes: [{\n        key: `cell-${item.key}`,\n        type: 'cell',\n        value: null,\n        level: 0,\n        rendered: null,\n        textValue: item.textValue,\n        hasChildNodes: false,\n        childNodes: []\n      }]\n    }))\n  }), [collection]);\n\n  let state = useGridState({\n    ...props,\n    selectionMode: cardOrientation === 'horizontal' && layoutType === 'grid' ? 'none' : props.selectionMode,\n    collection: gridCollection,\n    focusMode: 'cell'\n  });\n\n  cardViewLayout.collection = gridCollection;\n  cardViewLayout.disabledKeys = state.disabledKeys;\n  cardViewLayout.isLoading = isLoading;\n  cardViewLayout.direction = direction;\n\n  let {gridProps} = useGrid({\n    ...props,\n    isVirtualized: true,\n    keyboardDelegate: cardViewLayout\n  }, state, domRef);\n\n  type View = ReusableView<Node<T>, ReactNode>;\n  let renderWrapper = (parent: View, reusableView: View) => (\n    <VirtualizerItem\n      key={reusableView.key}\n      layoutInfo={reusableView.layoutInfo}\n      virtualizer={reusableView.virtualizer}\n      parent={parent?.layoutInfo}>\n      {reusableView.rendered}\n    </VirtualizerItem>\n  );\n\n  let focusedKey = state.selectionManager.focusedKey;\n  let focusedItem = gridCollection.getItem(state.selectionManager.focusedKey);\n  if (focusedItem?.parentKey != null) {\n    focusedKey = focusedItem.parentKey;\n  }\n\n  let margin = cardViewLayout.margin || 0;\n  let virtualizer = cardViewLayout.virtualizer;\n  let scrollToItem = useCallback((key) => {\n    virtualizer && virtualizer.scrollToItem(key, {\n      duration: 0,\n      offsetY: margin\n    });\n  }, [margin, virtualizer]);\n\n  // TODO: does aria-row count and aria-col count need to be modified? Perhaps aria-col count needs to be omitted\n  return (\n    <CardViewContext.Provider value={{state, isQuiet, layout: cardViewLayout, cardOrientation}}>\n      <Virtualizer\n        {...gridProps}\n        {...styleProps}\n        className={classNames(styles, 'spectrum-CardView')}\n        ref={domRef}\n        focusedKey={focusedKey}\n        scrollDirection=\"vertical\"\n        layout={cardViewLayout}\n        collection={gridCollection}\n        isLoading={isLoading}\n        onLoadMore={onLoadMore}\n        renderWrapper={renderWrapper}\n        transitionDuration={isLoading ? 160 : 220}\n        scrollToItem={scrollToItem}>\n        {(type, item) => {\n          if (type === 'item') {\n            return (\n              <InternalCard item={item} />\n            );\n          } else if (type === 'loader') {\n            return (\n              <CenteredWrapper>\n                <ProgressCircle\n                  isIndeterminate\n                  aria-label={state.collection.size > 0 ? stringFormatter.format('loadingMore') : stringFormatter.format('loading')} />\n              </CenteredWrapper>\n            );\n          } else if (type === 'placeholder') {\n            let emptyState = renderEmptyState ? renderEmptyState() : null;\n            if (emptyState == null) {\n              return null;\n            }\n\n            return (\n              <CenteredWrapper>\n                {emptyState}\n              </CenteredWrapper>\n            );\n          }\n        }}\n      </Virtualizer>\n    </CardViewContext.Provider>\n\n  );\n}\n\nfunction CenteredWrapper({children}) {\n  let {state} = useCardViewContext();\n  return (\n    <div\n      role=\"row\"\n      aria-rowindex={state.collection.size + 1}\n      className={classNames(styles, 'spectrum-CardView-centeredWrapper')}>\n      <div role=\"gridcell\">\n        {children}\n      </div>\n    </div>\n  );\n}\n\nfunction InternalCard(props) {\n  let {\n    item\n  } = props;\n  let cellNode = [...item.childNodes][0];\n  let {state, cardOrientation, isQuiet, layout} = useCardViewContext();\n\n  let layoutType = layout.layoutType;\n  let rowRef = useRef();\n  let cellRef = useRef<DOMRefValue<HTMLDivElement>>();\n  let unwrappedRef = useUnwrapDOMRef(cellRef);\n\n  let {rowProps: gridRowProps} = useGridRow({\n    node: item,\n    isVirtualized: true\n  }, state, rowRef);\n\n  let {gridCellProps} = useGridCell({\n    node: cellNode,\n    focusMode: 'cell'\n  }, state, unwrappedRef);\n\n  // Prevent space key from scrolling the CardView if triggered on a disabled item or on a Card in a selectionMode=\"none\" CardView.\n  let allowsInteraction = state.selectionManager.selectionMode !== 'none';\n  let isDisabled = !allowsInteraction || state.disabledKeys.has(item.key);\n\n  let onKeyDown = (e) => {\n    if (e.key === ' ' && isDisabled) {\n      e.preventDefault();\n    }\n  };\n\n  let rowProps = mergeProps(\n    gridRowProps,\n    {onKeyDown}\n  );\n\n  if (layoutType === 'grid' || layoutType === 'gallery') {\n    isQuiet = true;\n  }\n\n  if (layoutType !== 'grid') {\n    cardOrientation = 'vertical';\n  }\n\n  // We don't want to focus the checkbox (or any other focusable elements) within the Card\n  // when pressing the arrow keys so we delete the key down handler here. Arrow key navigation between\n  // the cards in the CardView is handled by useGrid => useSelectableCollection instead.\n  delete gridCellProps.onKeyDownCapture;\n  return (\n    <div {...rowProps} ref={rowRef} className={classNames(styles, 'spectrum-CardView-row')}>\n      <CardBase\n        ref={cellRef}\n        articleProps={gridCellProps}\n        isQuiet={isQuiet}\n        orientation={cardOrientation}\n        item={item}\n        layout={layoutType}>\n        {item.rendered}\n      </CardBase>\n    </div>\n  );\n}\n\n/**\n * TODO: Add description of component here.\n */\nconst _CardView = React.forwardRef(CardView) as <T>(props: SpectrumCardViewProps<T> & {ref?: DOMRef<HTMLDivElement>}) => ReactElement;\nexport {_CardView as CardView};\n","/*\n * Copyright 2021 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {AriaCardProps, SpectrumCardProps} from '@react-types/card';\nimport {Checkbox} from '@react-spectrum/checkbox';\nimport {classNames, SlotProvider, useDOMRef, useHasChild, useStyleProps} from '@react-spectrum/utils';\nimport {DOMRef, Node} from '@react-types/shared';\nimport {filterDOMProps, mergeProps, useLayoutEffect, useResizeObserver, useSlotId} from '@react-aria/utils';\nimport {FocusRing, getFocusableTreeWalker} from '@react-aria/focus';\nimport React, {HTMLAttributes, useCallback, useMemo, useRef, useState} from 'react';\nimport styles from '@adobe/spectrum-css-temp/components/card/vars.css';\nimport {useCardViewContext} from './CardViewContext';\nimport {useFocusWithin, useHover} from '@react-aria/interactions';\nimport {useProviderProps} from '@react-spectrum/provider';\n\ninterface CardBaseProps<T> extends SpectrumCardProps {\n  articleProps?: HTMLAttributes<HTMLElement>,\n  item?: Node<T>\n}\n\nfunction CardBase<T extends object>(props: CardBaseProps<T>, ref: DOMRef<HTMLDivElement>) {\n  props = useProviderProps(props);\n  let context = useCardViewContext() || {}; // we can call again here, won't change from Card.tsx\n  let {state} = context;\n  let manager = state?.selectionManager;\n  let {\n    isQuiet,\n    orientation = 'vertical',\n    articleProps = {},\n    item,\n    layout,\n    children\n  } = props;\n\n  let key = item?.key;\n  let isSelected = manager?.isSelected(key);\n  let isDisabled = state?.disabledKeys.has(key);\n  let onChange = () => manager?.select(key);\n\n  let {styleProps} = useStyleProps(props);\n  let {cardProps, titleProps, contentProps} = useCard(props);\n  let domRef = useDOMRef(ref);\n  let gridRef = useRef<HTMLDivElement>();\n  let checkboxRef = useRef(null);\n\n  // cards are only interactive if there is a selection manager and it allows selection\n  let {hoverProps, isHovered} = useHover({isDisabled: manager === undefined || manager?.selectionMode === 'none' || isDisabled});\n  let [isFocused, setIsFocused] = useState(false);\n  let {focusWithinProps} = useFocusWithin({\n    onFocusWithinChange: setIsFocused,\n    isDisabled\n  });\n\n  // ToDo: see css for comment about avatar under selector .spectrum-Card--noLayout.spectrum-Card--default\n  let hasPreviewImage = useHasChild(`.${styles['spectrum-Card-image']}`, gridRef);\n  let hasPreviewIllustration = useHasChild(`.${styles['spectrum-Card-illustration']}`, gridRef);\n  let hasPreview = hasPreviewImage || hasPreviewIllustration;\n\n  // this is for horizontal cards\n  let [height, setHeight] = useState(NaN);\n  let updateHeight = useCallback(() => {\n    if (orientation !== 'horizontal') {\n      return;\n    }\n\n    let cardHeight = gridRef.current.getBoundingClientRect().height;\n    setHeight(cardHeight);\n  }, [orientation, gridRef, setHeight]);\n  useResizeObserver({ref: gridRef, onResize: updateHeight});\n\n  let aspectRatioEnforce = undefined;\n  if (orientation === 'horizontal' && !isNaN(height)) {\n    aspectRatioEnforce = {\n      height: `${height}px`,\n      width: `${height}px`\n    };\n  }\n\n  let slots = useMemo(() => ({\n    image: {UNSAFE_className: classNames(styles, 'spectrum-Card-image'), objectFit: orientation === 'horizontal' ? 'cover' : 'contain', alt: '', ...aspectRatioEnforce},\n    illustration: {UNSAFE_className: classNames(styles, 'spectrum-Card-illustration'), ...aspectRatioEnforce},\n    avatar: {UNSAFE_className: classNames(styles, 'spectrum-Card-avatar'), size: 'avatar-size-400'},\n    heading: {UNSAFE_className: classNames(styles, 'spectrum-Card-heading'), ...titleProps},\n    content: {UNSAFE_className: classNames(styles, 'spectrum-Card-content'), ...contentProps},\n    detail: {UNSAFE_className: classNames(styles, 'spectrum-Card-detail')}\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }), [titleProps, contentProps, height, isQuiet, orientation]);\n\n  useLayoutEffect(() => {\n    if (gridRef?.current) {\n      let walker = getFocusableTreeWalker(gridRef.current);\n      let nextNode = walker.nextNode();\n      while (nextNode != null) {\n        if (checkboxRef.current && !checkboxRef.current.UNSAFE_getDOMNode().contains(nextNode)) {\n          console.warn('Card does not support focusable elements, please contact the team regarding your use case.');\n          break;\n        }\n        nextNode = walker.nextNode();\n      }\n    }\n  }, [children]);\n\n  return (\n    <FocusRing focusRingClass={classNames(styles, 'focus-ring')}>\n      <article\n        {...styleProps}\n        {...mergeProps(cardProps, focusWithinProps, hoverProps, filterDOMProps(props), articleProps)}\n        ref={domRef}\n        className={classNames(styles, 'spectrum-Card', {\n          'spectrum-Card--default': !isQuiet && orientation !== 'horizontal',\n          'spectrum-Card--isQuiet': isQuiet && orientation !== 'horizontal',\n          'spectrum-Card--horizontal': orientation === 'horizontal',\n          'spectrum-Card--noPreview': !hasPreview,\n          'is-hovered': isHovered,\n          'is-focused': isFocused,\n          'is-selected': isSelected,\n          'spectrum-Card--waterfall': layout === 'waterfall',\n          'spectrum-Card--gallery': layout === 'gallery',\n          'spectrum-Card--grid': layout === 'grid',\n          'spectrum-Card--noLayout': layout !== 'waterfall' && layout !== 'gallery' && layout !== 'grid'\n        }, styleProps.className)}>\n        <div ref={gridRef} className={classNames(styles, 'spectrum-Card-grid')}>\n          {manager && manager.selectionMode !== 'none' && (\n            <div className={classNames(styles, 'spectrum-Card-checkboxWrapper')}>\n              <Checkbox\n                ref={checkboxRef}\n                isDisabled={isDisabled}\n                excludeFromTabOrder\n                isSelected={isSelected}\n                onChange={onChange}\n                UNSAFE_className={classNames(styles, 'spectrum-Card-checkbox')}\n                isEmphasized\n                aria-label=\"select\" />\n            </div>\n          )}\n          <SlotProvider slots={slots}>\n            {children}\n          </SlotProvider>\n          <div className={classNames(styles, 'spectrum-Card-decoration')} />\n        </div>\n      </article>\n    </FocusRing>\n  );\n}\n\ninterface AriaCardOptions extends AriaCardProps {\n}\n\ninterface CardAria {\n  cardProps: HTMLAttributes<HTMLDivElement>,\n  titleProps: HTMLAttributes<HTMLDivElement>,\n  contentProps: HTMLAttributes<HTMLDivElement>\n}\n\nfunction useCard(props: AriaCardOptions): CardAria {\n  let titleId = useSlotId();\n  let descriptionId = useSlotId();\n  let titleProps = useMemo(() => ({\n    id: titleId\n  }), [titleId]);\n  let contentProps = useMemo(() => ({\n    id: descriptionId\n  }), [descriptionId]);\n\n  return {\n    cardProps: {\n      ...filterDOMProps(props),\n      'aria-labelledby': titleId,\n      'aria-describedby': descriptionId,\n      tabIndex: 0\n    },\n    titleProps,\n    contentProps\n  };\n}\n\n/**\n * TODO: Add description of component here.\n */\nconst _CardBase = React.forwardRef(CardBase);\nexport {_CardBase as CardBase};\n","/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\n@import './index.css';\n@import './skin.css';\n","/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport React, {useContext} from 'react';\n\nexport const CardViewContext = React.createContext(null);\n\nexport function useCardViewContext() {\n  return useContext(CardViewContext);\n}\n","const _temp0 = require(\"../intl/ar-AE.json\");\nconst _temp1 = require(\"../intl/bg-BG.json\");\nconst _temp2 = require(\"../intl/cs-CZ.json\");\nconst _temp3 = require(\"../intl/da-DK.json\");\nconst _temp4 = require(\"../intl/de-DE.json\");\nconst _temp5 = require(\"../intl/el-GR.json\");\nconst _temp6 = require(\"../intl/en-US.json\");\nconst _temp7 = require(\"../intl/es-ES.json\");\nconst _temp8 = require(\"../intl/et-EE.json\");\nconst _temp9 = require(\"../intl/fi-FI.json\");\nconst _temp10 = require(\"../intl/fr-FR.json\");\nconst _temp11 = require(\"../intl/he-IL.json\");\nconst _temp12 = require(\"../intl/hr-HR.json\");\nconst _temp13 = require(\"../intl/hu-HU.json\");\nconst _temp14 = require(\"../intl/it-IT.json\");\nconst _temp15 = require(\"../intl/ja-JP.json\");\nconst _temp16 = require(\"../intl/ko-KR.json\");\nconst _temp17 = require(\"../intl/lt-LT.json\");\nconst _temp18 = require(\"../intl/lv-LV.json\");\nconst _temp19 = require(\"../intl/nb-NO.json\");\nconst _temp20 = require(\"../intl/nl-NL.json\");\nconst _temp21 = require(\"../intl/pl-PL.json\");\nconst _temp22 = require(\"../intl/pt-BR.json\");\nconst _temp23 = require(\"../intl/pt-PT.json\");\nconst _temp24 = require(\"../intl/ro-RO.json\");\nconst _temp25 = require(\"../intl/ru-RU.json\");\nconst _temp26 = require(\"../intl/sk-SK.json\");\nconst _temp27 = require(\"../intl/sl-SI.json\");\nconst _temp28 = require(\"../intl/sr-SP.json\");\nconst _temp29 = require(\"../intl/sv-SE.json\");\nconst _temp30 = require(\"../intl/tr-TR.json\");\nconst _temp31 = require(\"../intl/uk-UA.json\");\nconst _temp32 = require(\"../intl/zh-CN.json\");\nconst _temp33 = require(\"../intl/zh-TW.json\");\nmodule.exports = {\n  \"ar-AE\": _temp0,\n  \"bg-BG\": _temp1,\n  \"cs-CZ\": _temp2,\n  \"da-DK\": _temp3,\n  \"de-DE\": _temp4,\n  \"el-GR\": _temp5,\n  \"en-US\": _temp6,\n  \"es-ES\": _temp7,\n  \"et-EE\": _temp8,\n  \"fi-FI\": _temp9,\n  \"fr-FR\": _temp10,\n  \"he-IL\": _temp11,\n  \"hr-HR\": _temp12,\n  \"hu-HU\": _temp13,\n  \"it-IT\": _temp14,\n  \"ja-JP\": _temp15,\n  \"ko-KR\": _temp16,\n  \"lt-LT\": _temp17,\n  \"lv-LV\": _temp18,\n  \"nb-NO\": _temp19,\n  \"nl-NL\": _temp20,\n  \"pl-PL\": _temp21,\n  \"pt-BR\": _temp22,\n  \"pt-PT\": _temp23,\n  \"ro-RO\": _temp24,\n  \"ru-RU\": _temp25,\n  \"sk-SK\": _temp26,\n  \"sl-SI\": _temp27,\n  \"sr-SP\": _temp28,\n  \"sv-SE\": _temp29,\n  \"tr-TR\": _temp30,\n  \"uk-UA\": _temp31,\n  \"zh-CN\": _temp32,\n  \"zh-TW\": _temp33\n}","{\n  \"loading\": \"جارٍ التحميل...\",\n  \"loadingMore\": \"جارٍ تحميل المزيد...\"\n}\n","{\n  \"loading\": \"Зареждане...\",\n  \"loadingMore\": \"Зареждане на още...\"\n}\n","{\n  \"loading\": \"Načítání...\",\n  \"loadingMore\": \"Načítání dalších...\"\n}\n","{\n  \"loading\": \"Indlæser...\",\n  \"loadingMore\": \"Indlæser flere...\"\n}\n","{\n  \"loading\": \"Wird geladen...\",\n  \"loadingMore\": \"Noch mehr wird geladen...\"\n}\n","{\n  \"loading\": \"Φόρτωση...\",\n  \"loadingMore\": \"Φόρτωση περισσότερων...\"\n}\n","{\n  \"loading\": \"Loading…\",\n  \"loadingMore\": \"Loading more…\"\n}\n","{\n  \"loading\": \"Cargando…\",\n  \"loadingMore\": \"Cargando más…\"\n}\n","{\n  \"loading\": \"Laadimine...\",\n  \"loadingMore\": \"Laadi rohkem...\"\n}\n","{\n  \"loading\": \"Ladataan…\",\n  \"loadingMore\": \"Ladataan lisää…\"\n}\n","{\n  \"loading\": \"Chargement en cours…\",\n  \"loadingMore\": \"Chargement d’autres d’éléments…\"\n}\n","{\n  \"loading\": \"טוען...\",\n  \"loadingMore\": \"טוען עוד...\"\n}\n","{\n  \"loading\": \"Učitavam...\",\n  \"loadingMore\": \"Učitavam još...\"\n}\n","{\n  \"loading\": \"Betöltés folyamatban…\",\n  \"loadingMore\": \"Továbbiak betöltése folyamatban…\"\n}\n","{\n  \"loading\": \"Caricamento...\",\n  \"loadingMore\": \"Caricamento altri...\"\n}\n","{\n  \"loading\": \"読み込み中...\",\n  \"loadingMore\": \"さらに読み込み中...\"\n}\n","{\n  \"loading\": \"로드 중…\",\n  \"loadingMore\": \"추가 로드 중…\"\n}\n","{\n  \"loading\": \"Įkeliama…\",\n  \"loadingMore\": \"Įkeliama daugiau…\"\n}\n","{\n  \"loading\": \"Notiek ielāde…\",\n  \"loadingMore\": \"Tiek ielādēts vēl...\"\n}\n","{\n  \"loading\": \"Laster inn...\",\n  \"loadingMore\": \"Laster inn flere...\"\n}\n","{\n  \"loading\": \"Laden...\",\n  \"loadingMore\": \"Meer laden...\"\n}\n","{\n  \"loading\": \"Wczytywanie...\",\n  \"loadingMore\": \"Wczytywanie większej liczby...\"\n}\n","{\n  \"loading\": \"Carregando...\",\n  \"loadingMore\": \"Carregando mais...\"\n}\n","{\n  \"loading\": \"A carregar...\",\n  \"loadingMore\": \"A carregar mais...\"\n}\n","{\n  \"loading\": \"Se încarcă...\",\n  \"loadingMore\": \"Se încarcă mai multe...\"\n}\n","{\n  \"loading\": \"Загрузка...\",\n  \"loadingMore\": \"Дополнительная загрузка...\"\n}\n","{\n  \"loading\": \"Načítava sa...\",\n  \"loadingMore\": \"Načítava sa viac...\"\n}\n","{\n  \"loading\": \"Nalaganje...\",\n  \"loadingMore\": \"Nalaganje dodatne vsebine...\"\n}\n","{\n  \"loading\": \"Učitavam...\",\n  \"loadingMore\": \"Učitavam još...\"\n}\n","{\n  \"loading\": \"Läser in...\",\n  \"loadingMore\": \"Läser in mer...\"\n}\n","{\n  \"loading\": \"Yükleniyor...\",\n  \"loadingMore\": \"Daha fazla yükleniyor...\"\n}\n","{\n  \"loading\": \"Завантаження…\",\n  \"loadingMore\": \"Завантаження інших об’єктів...\"\n}\n","{\n  \"loading\": \"正在加载...\",\n  \"loadingMore\": \"正在加载更多...\"\n}\n","{\n  \"loading\": \"正在載入…\",\n  \"loadingMore\": \"正在載入更多…\"\n}\n","/*\n * Copyright 2021 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {BaseLayout, BaseLayoutOptions} from './BaseLayout';\nimport {LayoutInfo, Rect, Size} from '@react-stately/virtualizer';\n\nexport interface GalleryLayoutOptions extends BaseLayoutOptions {\n  // /**\n  //  * The card size in the grid.\n  //  */\n  // cardSize?: 'S' | 'M' | 'L',\n  /**\n   * The the default row height. Note this must be larger than the min item height.\n   * @default 208\n   */\n  idealRowHeight?: number,\n  /**\n   * The spacing between items.\n   * @default 18 x 18\n   */\n  itemSpacing?: Size,\n  /**\n   * The vertical padding for an item.\n   * @default 78\n   */\n  itemPadding?: number,\n  /**\n   * Minimum size for a item in the grid.\n   * @default 136 x 136\n   */\n  minItemSize?: Size,\n  /**\n   * Target for adding extra weight to elements during linear partitioning. Anything with an aspect ratio smaler than this value\n   * will be targeted.\n   * @type {number}\n   */\n  threshold?: number\n}\n\nconst DEFAULT_OPTIONS = {\n  S: {\n    idealRowHeight: 112,\n    minItemSize: new Size(96, 96),\n    itemSpacing: new Size(8, 16),\n    itemPadding: 24,\n    dropSpacing: 50,\n    margin: 8\n  },\n  L: {\n    idealRowHeight: 208,\n    minItemSize: new Size(136, 136),\n    itemSpacing: new Size(18, 18),\n    itemPadding: {\n      'medium': 78,\n      'large': 99\n    },\n    dropSpacing: 100,\n    margin: 24\n  }\n};\n\nexport class GalleryLayout<T> extends BaseLayout<T> {\n  protected idealRowHeight: number;\n  protected itemSpacing: Size;\n  itemPadding: number;\n  protected minItemSize: Size;\n  protected threshold: number;\n\n  constructor(options: GalleryLayoutOptions = {}) {\n    super(options);\n    let cardSize = 'L';\n    this.idealRowHeight = options.idealRowHeight || DEFAULT_OPTIONS[cardSize].idealRowHeight;\n    this.itemSpacing = options.itemSpacing || DEFAULT_OPTIONS[cardSize].itemSpacing;\n    this.itemPadding = options.itemPadding != null ? options.itemPadding : DEFAULT_OPTIONS[cardSize].itemPadding[this.scale];\n    this.minItemSize = options.minItemSize || DEFAULT_OPTIONS[cardSize].minItemSize;\n    this.threshold = options.threshold || 1;\n    this.margin = options.margin != null ? options.margin : DEFAULT_OPTIONS[cardSize].margin;\n  }\n\n  get layoutType() {\n    return 'gallery';\n  }\n\n  /**\n   * Takes a row of widths and if there are any widths smaller than the min-width, leech width starting from\n   * the widest in the row until it can't give anymore, then move to the second widest and so forth.\n   * Do this until all assets meet the min-width.\n   * */\n  _distributeWidths(widths) {\n    // create a copy of the widths array and sort it largest to smallest\n    let sortedWidths = widths.concat().sort((a, b) => a[1] > b[1] ? -1 : 1);\n    for (let width of widths) {\n      // for each width, if it's smaller than the min width\n      if (width[1] < this.minItemSize.width) {\n        // then figure out how much smaller\n        let delta = this.minItemSize.width - width[1];\n        for (let item of sortedWidths) {\n          // go from the largest width in the row to the smallest\n          // if the width is greater than the min width\n          if (widths[item[0]][1] > this.minItemSize.width) {\n            // subtract the delta from the width, if it's still greater than the min width\n            // then we have finished, subtract the delta permanently from that width\n            // eslint-disable-next-line max-depth\n            if (widths[item[0]][1] - delta > this.minItemSize.width) {\n              widths[item[0]][1] -= delta;\n              delta = 0;\n              break;\n            } else {\n              // otherwise, we take as much as we can from the current width and then move on to\n              // the next largest and take some width from it\n              let maxChange = widths[item[0]][1] - this.minItemSize.width;\n              delta -= maxChange;\n              widths[item[0]][1] -= maxChange;\n            }\n          }\n        }\n        if (delta > 0) {\n          return false;\n        }\n        // force the width to be the min width that we just rebalanced for\n        width[1] = this.minItemSize.width;\n      }\n    }\n    return true;\n  }\n\n  buildCollection() {\n    let visibleWidth = this.virtualizer.visibleRect.width;\n    let visibleHeight = this.virtualizer.visibleRect.height;\n    let y = this.margin;\n    let availableWidth = visibleWidth - this.margin * 2;\n\n    // If avaliable width is not greater than 0, skip node layout calculations\n    if (availableWidth > 0) {\n      // Compute aspect ratios for all of the items, and the total width if all items were on in a single row.\n      let ratios = [];\n      let totalWidth = 0;\n      let minRatio = this.minItemSize.width / this.minItemSize.height;\n      let maxRatio = availableWidth / this.minItemSize.height;\n\n      for (let node of this.collection) {\n        let ratio = node.props.width / node.props.height;\n        if (ratio < minRatio) {\n          ratio = minRatio;\n        } else if (ratio > maxRatio && ratio !== minRatio) {\n          ratio = maxRatio;\n        }\n\n        let itemWidth = ratio * this.minItemSize.height;\n        ratios.push(ratio);\n        totalWidth += itemWidth;\n      }\n\n      totalWidth += this.itemSpacing.width * (this.collection.size - 1);\n\n      // Determine how many rows we'll need, and partition the items into rows\n      // using the aspect ratios as weights.\n      let rows = Math.max(1, Math.ceil(totalWidth / availableWidth));\n      // if the available width can't hold two items, then every item will get its own row\n      // this leads to a faster run through linear partition and more dependable output for small row widths\n      if (availableWidth <= (this.minItemSize.width * 2) + (this.itemPadding * 2)) {\n        rows = this.collection.size;\n      }\n\n      let weightedRatios = ratios.map(ratio => ratio < this.threshold ? ratio + (0.5 * (1 / ratio)) : ratio);\n      let partition = linearPartition(weightedRatios, rows);\n\n      let index = 0;\n      for (let row of partition) {\n        // Compute the total weight for this row\n        let totalWeight = 0;\n        for (let j = index; j < index + row.length; j++) {\n          totalWeight += ratios[j];\n        }\n\n        // Determine the row height based on the total available width and weight of this row.\n        let bestRowHeight = (availableWidth - (row.length - 1) * this.itemSpacing.width) / totalWeight;\n\n        // if this is the last row and the row height is >2x the ideal row height, then cap to the ideal height\n        // probably doing this because if the last row has one extremely tall image, then the row becomes huge\n        // though that can happen anywhere if a row has lots of tall images... so i'm not sure why this one matters\n        if (row === partition[partition.length - 1] && bestRowHeight > this.idealRowHeight * 2) {\n          bestRowHeight = this.idealRowHeight;\n        }\n        let itemHeight = Math.round(bestRowHeight) + this.itemPadding;\n        let x = this.margin;\n\n        // if any items are going to end up too small, add a bit of width to them and subtract it from wider objects\n        let widths = [];\n        for (let j = index; j < index + row.length; j++) {\n          let width = Math.round(bestRowHeight * ratios[j]);\n          widths.push([j - index, width]);\n        }\n        this._distributeWidths(widths);\n\n        // Create items for this row.\n        for (let j = index; j < index + row.length; j++) {\n          let node = this.collection.rows[j];\n          let itemWidth = Math.max(widths[j - index][1], this.minItemSize.width);\n          let rect = new Rect(x, y, itemWidth, itemHeight);\n          let layoutInfo = new LayoutInfo(node.type, node.key, rect);\n          layoutInfo.allowOverflow = true;\n          this.layoutInfos.set(node.key, layoutInfo);\n          x += itemWidth + this.itemSpacing.width;\n        }\n\n        y += itemHeight + this.itemSpacing.height;\n        index += row.length;\n      }\n\n      if (this.isLoading) {\n        let loaderY = y;\n        let loaderHeight = 60;\n        // If there aren't any items, make loader take all avaliable room and remove margin from y calculation\n        // so it doesn't scroll\n        if (this.collection.size === 0) {\n          loaderY = 0;\n          loaderHeight = visibleHeight || 60;\n        }\n\n        let rect = new Rect(0, loaderY, visibleWidth, loaderHeight);\n        let loader = new LayoutInfo('loader', 'loader', rect);\n        this.layoutInfos.set('loader', loader);\n        y = loader.rect.maxY;\n      }\n\n      if (this.collection.size === 0 && !this.isLoading) {\n        let rect = new Rect(0, 0, visibleWidth, visibleHeight);\n        let placeholder = new LayoutInfo('placeholder', 'placeholder', rect);\n        this.layoutInfos.set('placeholder', placeholder);\n        y = placeholder.rect.maxY;\n      }\n    }\n    this.contentSize = new Size(visibleWidth, y);\n  }\n}\n\n// https://www8.cs.umu.se/kurser/TDBA77/VT06/algorithms/BOOK/BOOK2/NODE45.HTM\nfunction linearPartition(seq, k) {\n  let n = seq.length;\n  if (k <= 0) {\n    return [];\n  }\n\n  if (k >= n) {\n    return seq.map(x => [x]);\n  }\n\n  if (n === 1) {\n    return [seq];\n  }\n\n  let table = Array(n).fill(0).map(() => Array(k).fill(0));\n  let solution = Array(n - 1).fill(0).map(() => Array(k - 1).fill(0));\n\n  for (let i = 0; i < n; i++) {\n    table[i][0] = seq[i] + (i > 0 ? table[i - 1][0] : 0);\n  }\n\n  for (let i = 0; i < k; i++) {\n    table[0][i] = seq[0];\n  }\n\n  for (let i = 1; i < n; i++) {\n    for (let j = 1; j < k; j++) {\n      let currentMin = 0;\n      let minX = Infinity;\n\n      for (let x = 0; x < i; x++) {\n        let c1 = table[x][j - 1];\n        let c2 = table[i][0] - table[x][0];\n        let cost = Math.max(c1, c2);\n\n        if (!x || cost < currentMin) {\n          currentMin = cost;\n          minX = x;\n        }\n      }\n\n      table[i][j] = currentMin;\n      solution[i - 1][j - 1] = minX;\n    }\n  }\n\n  n = n - 1;\n  k = k - 2;\n\n  let result = [];\n  while (k >= 0) {\n    if (n >= 1) {\n      let row = [];\n      for (let i = solution[n - 1][k] + 1; i < n + 1; i++) {\n        row.push(seq[i]);\n      }\n\n      result.unshift(row);\n      n = solution[n - 1][k];\n    }\n\n    k--;\n  }\n\n  let row = [];\n  for (let i = 0; i < n + 1; i++) {\n    row.push(seq[i]);\n  }\n\n  result.unshift(row);\n\n  return result;\n}\n","/*\n * Copyright 2021 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {Direction, KeyboardDelegate, Node} from '@react-types/shared';\nimport {getChildNodes, getFirstItem} from '@react-stately/collections';\nimport {GridCollection} from '@react-stately/grid';\nimport {InvalidationContext, Layout, LayoutInfo, Rect, Size} from '@react-stately/virtualizer';\nimport {Key} from 'react';\nimport {Scale} from '@react-types/provider';\n\nexport interface BaseLayoutOptions {\n  collator?: Intl.Collator,\n  // TODO: is this valid or is scale a spectrum specific thing that should be left out of the layouts?\n  scale?: Scale,\n  /**\n   * The margin around the grid view between the edges and the items.\n   * @default 24\n   */\n  margin?: number\n}\n\nexport class BaseLayout<T> extends Layout<Node<T>> implements KeyboardDelegate {\n  protected contentSize: Size;\n  protected layoutInfos: Map<Key, LayoutInfo>;\n  protected collator: Intl.Collator;\n  protected lastCollection: GridCollection<T>;\n  collection:  GridCollection<T>;\n  isLoading: boolean;\n  disabledKeys: Set<Key> = new Set();\n  direction: Direction;\n  scale: Scale;\n  margin: number;\n\n  constructor(options: BaseLayoutOptions = {}) {\n    super();\n    this.layoutInfos = new Map();\n    this.collator = options.collator;\n    this.lastCollection = null;\n    this.scale = options.scale || 'medium';\n    this.margin = options.margin || 24;\n  }\n\n  validate(invalidationContext: InvalidationContext<Node<T>, unknown>) {\n    this.collection = this.virtualizer.collection as GridCollection<T>;\n    this.buildCollection(invalidationContext);\n\n    // Remove layout info that doesn't exist in new collection\n    if (this.lastCollection) {\n      for (let key of this.lastCollection.getKeys()) {\n        if (!this.collection.getItem(key)) {\n          this.layoutInfos.delete(key);\n        }\n      }\n\n      if (!this.isLoading) {\n        this.layoutInfos.delete('loader');\n      }\n\n      if (this.collection.size > 0) {\n        this.layoutInfos.delete('placeholder');\n      }\n    }\n\n    this.lastCollection = this.collection;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  buildCollection(invalidationContext?: InvalidationContext<Node<T>, unknown>) {}\n\n  getContentSize() {\n    return this.contentSize;\n  }\n\n  getLayoutInfo(key: Key) {\n    return this.layoutInfos.get(key);\n  }\n\n  getVisibleLayoutInfos(rect) {\n    let res: LayoutInfo[] = [];\n\n    for (let layoutInfo of this.layoutInfos.values()) {\n      if (this.isVisible(layoutInfo, rect)) {\n        res.push(layoutInfo);\n      }\n    }\n\n    return res;\n  }\n\n  isVisible(layoutInfo: LayoutInfo, rect: Rect) {\n    return layoutInfo.rect.intersects(rect);\n  }\n\n  getInitialLayoutInfo(layoutInfo: LayoutInfo) {\n    layoutInfo.opacity = 0;\n    layoutInfo.transform = 'scale3d(0.8, 0.8, 0.8)';\n    return layoutInfo;\n  }\n\n  getFinalLayoutInfo(layoutInfo: LayoutInfo) {\n    layoutInfo.opacity = 0;\n    layoutInfo.transform = 'scale3d(0.8, 0.8, 0.8)';\n    return layoutInfo;\n  }\n\n  _findClosestLayoutInfo(target: Rect, rect: Rect) {\n    let layoutInfos = this.getVisibleLayoutInfos(rect);\n    let best = null;\n    let bestDistance = Infinity;\n\n    // Calculates distance as the distance between the center of 2 rects.\n    for (let cur of layoutInfos) {\n      if (cur.type === 'item') {\n        let curRect = cur.rect;\n        let targetMidX = (target.x + target.maxX) / 2;\n        let targetMidY = (target.y + target.maxY) / 2;\n        let curMidX = (curRect.x + curRect.maxX) / 2;\n        let curMidY = (curRect.y + curRect.maxY) / 2;\n        let dist = Math.pow(targetMidX - curMidX, 2) + Math.pow(targetMidY - curMidY, 2);\n        if (dist < bestDistance) {\n          best = cur;\n          bestDistance = dist;\n        }\n      }\n    }\n\n    return best;\n  }\n\n  _findClosest(target: Rect, rect: Rect) {\n    let best = this._findClosestLayoutInfo(target, rect);\n    return best || null;\n  }\n\n  getKeyBelow(key: Key) {\n    // Expected key is the currently focused cell so we need the parent row key\n    let parentRowKey = this.collection.getItem(key).parentKey;\n    let layoutInfo = this.getLayoutInfo(parentRowKey);\n    let rect = new Rect(layoutInfo.rect.x, layoutInfo.rect.maxY + 1, layoutInfo.rect.width, this.virtualizer.visibleRect.height);\n    let closestRow = this.collection.getItem(this._findClosest(layoutInfo.rect, rect)?.key);\n    return getFirstItem(getChildNodes(closestRow, this.collection))?.key;\n  }\n\n  getKeyAbove(key: Key) {\n    // Expected key is the currently focused cell so we need the parent row key\n    let parentRowKey = this.collection.getItem(key).parentKey;\n    let layoutInfo = this.getLayoutInfo(parentRowKey);\n    let rect = new Rect(layoutInfo.rect.x, 0, layoutInfo.rect.width, layoutInfo.rect.y - 1);\n    let closestRow = this.collection.getItem(this._findClosest(layoutInfo.rect, rect)?.key);\n    return getFirstItem(getChildNodes(closestRow, this.collection))?.key;\n  }\n\n  getKeyRightOf(key: Key) {\n    // Expected key is the currently focused cell so we need the parent row key\n    let parentRowKey = this.collection.getItem(key).parentKey;\n    key = this.direction === 'rtl' ?  this.collection.getKeyBefore(parentRowKey) : this.collection.getKeyAfter(parentRowKey);\n\n    while (key != null) {\n      let item = this.collection.getItem(key);\n      // Don't check if item is disabled because we want to be able to focus disabled items in a grid (double check this)\n      if (item.type === 'item') {\n        return getFirstItem(getChildNodes(item, this.collection))?.key;\n      }\n      key = this.direction === 'rtl' ?  this.collection.getKeyBefore(key) : this.collection.getKeyAfter(key);\n    }\n  }\n\n  getKeyLeftOf(key: Key) {\n    // Expected key is the currently focused cell so we need the parent row key\n    let parentRowKey = this.collection.getItem(key).parentKey;\n    key = this.direction === 'rtl' ?  this.collection.getKeyAfter(parentRowKey) : this.collection.getKeyBefore(parentRowKey);\n    while (key != null) {\n      let item = this.collection.getItem(key);\n      // Don't check if item is disabled because we want to be able to focus disabled items in a grid (double check this)\n      if (item.type === 'item') {\n        return getFirstItem(getChildNodes(item, this.collection))?.key;\n      }\n\n      key = this.direction === 'rtl' ?  this.collection.getKeyAfter(key) : this.collection.getKeyBefore(key);\n    }\n  }\n\n  getFirstKey() {\n    let firstRow = this.collection.getItem(this.collection.getFirstKey());\n    return getFirstItem(getChildNodes(firstRow, this.collection))?.key;\n  }\n\n  getLastKey() {\n    let lastRow = this.collection.getItem(this.collection.getLastKey());\n    return getFirstItem(getChildNodes(lastRow, this.collection))?.key;\n  }\n\n  // TODO: pretty unwieldy because it needs to bounce back and forth between the parent key and the child key\n  // Perhaps have layoutInfo store childKey as well so we don't need to do this? Or maybe make the layoutInfos be the cells instead of the rows?\n  getKeyPageAbove(key: Key) {\n    // Expected key is the currently focused cell so we need the parent row key\n    let parentRowKey = this.collection.getItem(key).parentKey;\n    let layoutInfo = this.getLayoutInfo(parentRowKey);\n\n    if (layoutInfo) {\n      let pageY = Math.max(0, layoutInfo.rect.y + layoutInfo.rect.height - this.virtualizer.visibleRect.height);\n      // If the node is so large that it spans multiple page heights, return the key of the item immediately above\n      // Otherwise keep going up until we exceed a single page height worth of nodes\n      let keyAbove = this.collection.getItem(this.getKeyAbove(key))?.parentKey;\n      layoutInfo = this.getLayoutInfo(keyAbove);\n\n      if (layoutInfo && layoutInfo.rect.y > pageY) {\n        while (layoutInfo && layoutInfo.rect.y > pageY) {\n          let childKey = getFirstItem(getChildNodes(this.collection.getItem(layoutInfo.key), this.collection))?.key;\n          let keyAbove = this.collection.getItem(this.getKeyAbove(childKey))?.parentKey;\n          layoutInfo = this.getLayoutInfo(keyAbove);\n        }\n      }\n\n      if (layoutInfo) {\n        let childKey = getFirstItem(getChildNodes(this.collection.getItem(layoutInfo.key), this.collection))?.key;\n        return childKey;\n      }\n    }\n\n    return this.getFirstKey();\n  }\n\n  // TODO: pretty unwieldy because it needs to bounce back and forth between the parent key and the child key\n  // Perhaps have layoutInfo store childKey as well so we don't need to do this?\n  getKeyPageBelow(key: Key) {\n    // Expected key is the currently focused cell so we need the parent row key\n    let parentRowKey = this.collection.getItem(key).parentKey;\n    let layoutInfo = this.getLayoutInfo(parentRowKey);\n    if (layoutInfo) {\n      let pageY = Math.min(this.virtualizer.contentSize.height, layoutInfo.rect.y - layoutInfo.rect.height + this.virtualizer.visibleRect.height);\n      // If the node is so large that it spans multiple page heights, return the key of the item immediately below\n      // Otherwise keep going up until we exceed a single page height worth of nodes\n      let keyBelow =  this.collection.getItem(this.getKeyBelow(key))?.parentKey;\n      layoutInfo = this.getLayoutInfo(keyBelow);\n      if (layoutInfo && layoutInfo.rect.y < pageY) {\n        while (layoutInfo && layoutInfo.rect.y < pageY) {\n          let childKey = getFirstItem(getChildNodes(this.collection.getItem(layoutInfo.key), this.collection))?.key;\n          let keyBelow = this.collection.getItem(this.getKeyBelow(childKey))?.parentKey;\n          layoutInfo = this.getLayoutInfo(keyBelow);\n        }\n      }\n\n      if (layoutInfo) {\n        let childKey = getFirstItem(getChildNodes(this.collection.getItem(layoutInfo.key), this.collection))?.key;\n        return childKey;\n      }\n    }\n\n    return this.getLastKey();\n  }\n\n  getKeyForSearch(search: string, fromKey?: Key) {\n    if (!this.collator) {\n      return null;\n    }\n\n    let collection = this.collection;\n    let key = fromKey ?? this.getFirstKey();\n\n    let startItem = collection.getItem(key);\n    key = startItem.parentKey;\n\n    while (key != null) {\n      let item = collection.getItem(key);\n      if (item.textValue) {\n        let substring = item.textValue.slice(0, search.length);\n        if (this.collator.compare(substring, search) === 0) {\n          return getFirstItem(getChildNodes(item, this.collection))?.key;\n        }\n      }\n\n      key = this.collection.getKeyAfter(key);\n    }\n\n    return null;\n  }\n}\n","/*\n * Copyright 2021 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {BaseLayout, BaseLayoutOptions} from './BaseLayout';\nimport {getChildNodes, getFirstItem} from '@react-stately/collections';\nimport {Key} from 'react';\nimport {LayoutInfo, Rect, Size} from '@react-stately/virtualizer';\nimport {Node, Orientation} from '@react-types/shared';\n\nexport interface GridLayoutOptions extends BaseLayoutOptions {\n  // /**\n  //  * The card size in the grid.\n  //  */\n  // cardSize?: 'S' | 'M' | 'L',\n  /**\n   * The minimum item size.\n   * @default 208 x 208 for horizontal card orientation. 102 x 102 for vertical card orientation.\n   */\n  minItemSize?: Size,\n  /**\n   * The maximum item size.\n   * @default Infinity\n   */\n  maxItemSize?: Size,\n  /**\n   * The minimum space required between items.\n   * @default 18 x 18\n   */\n  minSpace?: Size,\n  /**\n   * The maximum number of columns.\n   * @default Infinity\n   */\n  maxColumns?: number,\n  /**\n   * The additional padding along the card's main axis. Affects the sizing of the content area following the card image.\n   * @default 95\n   */\n  itemPadding?: number,\n  /**\n   * The orientation of the cards withn the grid.\n   * @default vertical\n   */\n  cardOrientation?: Orientation\n}\n\nconst DEFAULT_OPTIONS = {\n  S: {\n    itemPadding: 20,\n    minItemSize: {\n      'vertical': new Size(96, 96)\n    },\n    maxItemSize: new Size(Infinity, Infinity),\n    margin: 8,\n    minSpace: new Size(6, 6),\n    maxColumns: Infinity,\n    dropSpacing: 50\n  },\n  L: {\n    itemPadding: {\n      'vertical': {\n        'medium': 78,\n        'large': 98\n      },\n      'horizontal': {\n        'medium': 150,\n        'large': 170\n      }\n    },\n    minItemSize: {\n      'vertical': new Size(208, 208),\n      'horizontal': new Size(102, 102)\n    },\n    maxItemSize: new Size(Infinity, Infinity),\n    margin: 24,\n    minSpace: new Size(18, 18),\n    maxColumns: Infinity,\n    dropSpacing: 100\n  }\n};\n\nexport class GridLayout<T> extends BaseLayout<T> {\n  protected minItemSize: Size;\n  protected maxItemSize: Size;\n  protected minSpace: Size;\n  protected maxColumns: number;\n  itemPadding: number;\n  cardOrientation: Orientation;\n  protected itemSize: Size;\n  protected numColumns: number;\n  protected numRows: number;\n  protected horizontalSpacing: number;\n\n  constructor(options: GridLayoutOptions = {}) {\n    super(options);\n    let cardSize = 'L';\n    this.cardOrientation = options.cardOrientation || 'vertical';\n    this.minItemSize = options.minItemSize || DEFAULT_OPTIONS[cardSize].minItemSize[this.cardOrientation];\n    this.maxItemSize = options.maxItemSize || DEFAULT_OPTIONS[cardSize].maxItemSize;\n    this.margin = options.margin != null ? options.margin : DEFAULT_OPTIONS[cardSize].margin;\n    this.minSpace = options.minSpace || DEFAULT_OPTIONS[cardSize].minSpace;\n    this.maxColumns = options.maxColumns || DEFAULT_OPTIONS[cardSize].maxColumns;\n    this.itemPadding = options.itemPadding != null ? options.itemPadding : DEFAULT_OPTIONS[cardSize].itemPadding[this.cardOrientation][this.scale];\n    this.itemSize = null;\n    this.numColumns = 0;\n    this.numRows = 0;\n    this.horizontalSpacing = 0;\n  }\n\n  get layoutType() {\n    return 'grid';\n  }\n\n  getIndexAtPoint(x, y, allowInsertingAtEnd = false) {\n    let itemHeight = this.itemSize.height + this.minSpace.height;\n    let itemWidth = this.itemSize.width + this.horizontalSpacing;\n    return Math.max(0,\n      Math.min(\n        this.collection.size - (allowInsertingAtEnd ? 0 : 1),\n        Math.floor(y / itemHeight) * this.numColumns + Math.floor((x - this.horizontalSpacing) / itemWidth)\n      )\n    );\n  }\n\n  getVisibleLayoutInfos(rect) {\n    let res: LayoutInfo[] = [];\n    let numItems = this.collection.size;\n    if (numItems <= 0 || !this.itemSize) {\n      // If there aren't any items in the collection, we are in a loader/placeholder state. Return those layoutInfos as\n      // the currently visible items\n      if (this.layoutInfos.size > 0) {\n        for (let layoutInfo of this.layoutInfos.values()) {\n          if (this.isVisible(layoutInfo, rect)) {\n            res.push(layoutInfo);\n          }\n        }\n      }\n    } else {\n      // The approach from v2 uses indexes where other v3 layouts iterate through every node/root node. This feels more efficient\n      let firstVisibleItem = this.getIndexAtPoint(rect.x, rect.y);\n      let lastVisibleItem = this.getIndexAtPoint(rect.maxX, rect.maxY);\n      for (let index = firstVisibleItem; index <= lastVisibleItem; index++) {\n        let keyFromIndex = this.collection.rows[index].key;\n        let layoutInfo = this.layoutInfos.get(keyFromIndex);\n        if (layoutInfo && this.isVisible(layoutInfo, rect)) {\n          res.push(layoutInfo);\n        }\n      }\n\n      // Check if loader is in view and add to res if so\n      let loader = this.layoutInfos.get('loader');\n      if (loader && this.isVisible(loader, rect)) {\n        res.push(loader);\n      }\n    }\n\n    return res;\n  }\n\n  buildCollection() {\n    let visibleWidth = this.virtualizer.visibleRect.width;\n    let visibleHeight = this.virtualizer.visibleRect.height;\n    let horizontalItemPadding = this.cardOrientation === 'horizontal' ? this.itemPadding : 0;\n    let verticalItemPadding = this.cardOrientation === 'vertical' ? this.itemPadding : 0;\n    let minCardWidth = this.minItemSize.width + horizontalItemPadding;\n\n    // Compute the number of rows and columns needed to display the content\n    let availableWidth = visibleWidth - this.margin * 2;\n    let columns = Math.floor((availableWidth + this.minSpace.width) / (minCardWidth + this.minSpace.width));\n    this.numColumns = Math.max(1, Math.min(this.maxColumns, columns));\n    this.numRows = Math.ceil(this.collection.size / this.numColumns);\n\n    // Compute the available width (minus the space between items)\n    let width = availableWidth - (this.minSpace.width * Math.max(0, this.numColumns - 1));\n\n    // Compute the item width based on the space available\n    let itemWidth = Math.floor(width / this.numColumns);\n    itemWidth = Math.max(minCardWidth, Math.min(this.maxItemSize.width, itemWidth));\n    // Compute the item height, which is proportional to the item width\n    let t = ((itemWidth - minCardWidth) / minCardWidth);\n    let itemHeight = Math.floor(this.minItemSize.height + this.minItemSize.height * t);\n    itemHeight = Math.max(this.minItemSize.height, Math.min(this.maxItemSize.height, itemHeight)) + verticalItemPadding;\n    this.itemSize = new Size(itemWidth, itemHeight);\n\n    // Compute the horizontal spacing and content height\n    this.horizontalSpacing = this.numColumns < 2 ? 0 : Math.floor((availableWidth - this.numColumns * this.itemSize.width) / (this.numColumns - 1));\n\n    let y = this.margin;\n    let index = 0;\n    for (let node of this.collection) {\n      let layoutInfo = this.buildChild(node, y, index);\n      y = layoutInfo.rect.maxY;\n      index++;\n    }\n\n    if (this.isLoading) {\n      let loaderY = y;\n      let loaderHeight = 60;\n      // If there aren't any items, make loader take all avaliable room and remove margin from y calculation\n      // so it doesn't scroll\n      if (this.collection.size === 0) {\n        loaderY = 0;\n        loaderHeight = visibleHeight || 60;\n      }\n\n      let rect = new Rect(0, loaderY, visibleWidth, loaderHeight);\n      let loader = new LayoutInfo('loader', 'loader', rect);\n      this.layoutInfos.set('loader', loader);\n      y = loader.rect.maxY;\n    }\n\n    if (this.collection.size === 0 && !this.isLoading) {\n      let rect = new Rect(0, 0, visibleWidth, visibleHeight);\n      let placeholder = new LayoutInfo('placeholder', 'placeholder', rect);\n      this.layoutInfos.set('placeholder', placeholder);\n      y = placeholder.rect.maxY;\n    }\n\n    this.contentSize = new Size(visibleWidth, y);\n  }\n\n  buildChild(node: Node<T>, y: number, index: number): LayoutInfo {\n    let row = Math.floor(index / this.numColumns);\n    let column = index % this.numColumns;\n    let x = this.margin + column * (this.itemSize.width + this.horizontalSpacing);\n    y = this.margin + row * (this.itemSize.height + this.minSpace.height);\n\n    let rect = new Rect(x, y, this.itemSize.width, this.itemSize.height);\n    // TODO: Perhaps have it so that the child key for each row is stored with the layoutInfo?\n    let layoutInfo = new LayoutInfo(node.type, node.key, rect);\n    layoutInfo.allowOverflow = true;\n    this.layoutInfos.set(node.key, layoutInfo);\n    return layoutInfo;\n  }\n\n  // Since the collection doesn't represent the visual layout, need to calculate what row and column the current key is in,\n  // then return the key that occupies the row + column below. This can be done by figuring out how many cards exist per column then dividing the\n  // collection contents by that number (which will give us the row distribution)\n  getKeyBelow(key: Key) {\n    // Expected key is the currently focused cell so we need the parent row key\n    let parentRowKey = this.collection.getItem(key).parentKey;\n    let indexRowBelow;\n    let index = this.collection.rows.findIndex(card => card.key === parentRowKey);\n    if (index !== -1) {\n      indexRowBelow = index + this.numColumns;\n    } else {\n      return null;\n    }\n\n    let row = this.collection.rows[indexRowBelow];\n    return getFirstItem(getChildNodes(row, this.collection))?.key;\n  }\n\n  getKeyAbove(key: Key) {\n    // Expected key is the currently focused cell so we need the parent row key\n    let parentRowKey = this.collection.getItem(key).parentKey;\n    let indexRowAbove;\n    let index = this.collection.rows.findIndex(card => card.key === parentRowKey);\n    if (index !== -1) {\n      indexRowAbove = index - this.numColumns;\n    } else {\n      return null;\n    }\n\n    let row = this.collection.rows[indexRowAbove];\n    return getFirstItem(getChildNodes(row, this.collection))?.key;\n  }\n}\n","/*\n * Copyright 2021 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {BaseLayout, BaseLayoutOptions} from './BaseLayout';\nimport {getChildNodes, getFirstItem} from '@react-stately/collections';\nimport {InvalidationContext, LayoutInfo, Rect, Size} from '@react-stately/virtualizer';\nimport {Key} from 'react';\nimport {KeyboardDelegate, Node} from '@react-types/shared';\n\nexport interface WaterfallLayoutOptions extends BaseLayoutOptions {\n  /**\n   * The minimum item size.\n   * @default 240 x 136\n   */\n  minItemSize?: Size,\n  /**\n   * The maximum item size.\n   * @default Infinity\n   */\n  maxItemSize?: Size,\n  /**\n   * The minimum space required between items.\n   * @default 18 x 18\n   */\n  minSpace?: Size,\n  /**\n   * The maximum number of columns.\n   * @default Infinity\n   */\n  maxColumns?: number\n}\n\n// TODO: this didn't have any options that varied with card size, should it have?\nexport class WaterfallLayout<T> extends BaseLayout<T> implements KeyboardDelegate {\n  protected minItemSize: Size;\n  protected maxItemSize: Size;\n  protected minSpace: Size;\n  protected maxColumns: number;\n  protected numColumns: number;\n  protected itemWidth: number;\n  protected horizontalSpacing: number;\n\n  constructor(options: WaterfallLayoutOptions = {}) {\n    // TODO: WaterfallLayout doesn't use card size in v2, but perhaps it should support it? Perhaps it would modify\n    // minItemSize defaults or other things\n    super(options);\n    this.minItemSize = options.minItemSize || new Size(240, 136);\n    this.maxItemSize = options.maxItemSize || new Size(Infinity, Infinity);\n    this.margin = options.margin != null ? options.margin : 24;\n    this.minSpace = options.minSpace || new Size(18, 18);\n    this.maxColumns = options.maxColumns || Infinity;\n\n    this.itemWidth = 0;\n    this.numColumns = 0;\n\n    this.lastCollection = null;\n    this.collator = options.collator;\n  }\n\n  get layoutType() {\n    return 'waterfall';\n  }\n\n  buildCollection(invalidationContext: InvalidationContext<Node<T>, unknown>) {\n    // Compute the number of columns needed to display the content\n    let visibleWidth = this.virtualizer.visibleRect.width;\n    let availableWidth = visibleWidth - this.margin * 2;\n    let columns = Math.floor((availableWidth + this.minSpace.width) / (this.minItemSize.width + this.minSpace.width));\n    this.numColumns = Math.max(1, Math.min(this.maxColumns, columns));\n\n\n    // Compute the available width (minus the space between items)\n    let width = availableWidth - (this.minSpace.width * (this.numColumns - 1));\n\n    // Compute the item width based on the space available\n    let itemWidth = Math.round(width / this.numColumns);\n    itemWidth = Math.max(this.minItemSize.width, Math.min(this.maxItemSize.width, itemWidth));\n    this.itemWidth = itemWidth;\n\n    // Compute the horizontal spacing\n    // if only one column, we cannot divide by zero, so set it to 1\n    let horizontalSpacing = Math.round((availableWidth - this.numColumns * itemWidth) / Math.max(1, this.numColumns - 1));\n    this.horizontalSpacing = horizontalSpacing;\n\n    // Setup an array of column heights\n    let columnHeights = Array(this.numColumns).fill(this.margin);\n    for (let node of this.collection) {\n      let key = node.key;\n      // Compute the height of the item. Use the existing height if available,\n      // otherwise call the delegate to estimate the size.\n      let oldLayoutInfo = this.layoutInfos.get(key);\n      let height;\n      let estimatedSize = true;\n      if (oldLayoutInfo) {\n        height = oldLayoutInfo.rect.height;\n        estimatedSize = invalidationContext.sizeChanged || oldLayoutInfo.estimatedSize;\n      } else if (node.props.width && node.props.height) {\n        let nodeWidth = node.props.width;\n        let nodeHeight = node.props.height;\n        let scaledHeight = Math.round(nodeHeight * ((itemWidth) / nodeWidth));\n        height = Math.max(this.minItemSize.height, Math.min(this.maxItemSize.height, scaledHeight));\n      } else {\n        height = itemWidth;\n      }\n\n      // Figure out which column to place the item in, and compute its position.\n      let column = this.getNextColumnIndex(columnHeights);\n      let x = this.margin + column * (itemWidth + horizontalSpacing);\n      let y = columnHeights[column];\n\n      let rect = new Rect(x, y, itemWidth, height);\n      let layoutInfo = new LayoutInfo(node.type, key, rect);\n      layoutInfo.estimatedSize = estimatedSize;\n      layoutInfo.allowOverflow = true;\n      this.layoutInfos.set(key, layoutInfo);\n\n      // TODO: From v2 figure out this bit, when does this get called and what to replace this.collectionView._transaction with?\n      // Removing it from v2 doesn't seem to do anything?\n      // if (layoutInfo.estimatedSize && !invalidationContext.contentChanged && !this.collectionView._transaction) {\n      //   this.updateItemSize(new IndexPath(section, i));\n      // }\n\n      columnHeights[column] += layoutInfo.rect.height + this.minSpace.height;\n    }\n\n    // Reset all columns to the maximum for the next section\n    let maxHeight = Math.max.apply(Math, columnHeights) - this.minSpace.height + this.margin;\n    columnHeights.fill(maxHeight);\n    let y = columnHeights[0];\n\n    if (this.isLoading) {\n      let loaderY = y;\n      let loaderHeight = 60;\n      // If there aren't any items, make loader take all avaliable room and remove margin from y calculation\n      // so it doesn't scroll\n      if (this.collection.size === 0) {\n        loaderY = 0;\n        loaderHeight = this.virtualizer.visibleRect.height || 60;\n      }\n\n      let rect = new Rect(0, loaderY, this.virtualizer.visibleRect.width, loaderHeight);\n      let loader = new LayoutInfo('loader', 'loader', rect);\n      this.layoutInfos.set('loader', loader);\n      y = loader.rect.maxY;\n    }\n\n    if (this.collection.size === 0 && !this.isLoading) {\n      let rect = new Rect(0, 0, this.virtualizer.visibleRect.width, this.virtualizer.visibleRect.height);\n      let placeholder = new LayoutInfo('placeholder', 'placeholder', rect);\n      this.layoutInfos.set('placeholder', placeholder);\n      y = placeholder.rect.maxY;\n    }\n\n    this.contentSize = new Size(this.virtualizer.visibleRect.width, y);\n  }\n\n  updateItemSize(key: Key, size: Size) {\n    let layoutInfo = this.layoutInfos.get(key);\n    if (!size || !layoutInfo) {\n      return false;\n    }\n\n    if (size.height !== layoutInfo.rect.height) {\n      // TODO: also not sure about copying layout info vs mutating it. Listlayout does the below\n      // but I feel that is because it actually maintained a layoutNode map cache which this doesn't have\n      let newLayoutInfo = layoutInfo.copy();\n      newLayoutInfo.rect.height = size.height < 600 ? size.height : 600;\n      newLayoutInfo.estimatedSize = false;\n      this.layoutInfos.set(key, newLayoutInfo);\n      return true;\n    }\n\n    return false;\n  }\n\n  getNextColumnIndex(columnHeights) {\n    let minIndex = 0;\n    for (let i = 0; i < columnHeights.length; i++) {\n      if (columnHeights[i] < columnHeights[minIndex]) {\n        minIndex = i;\n      }\n    }\n\n    return minIndex;\n  }\n\n  getClosestRight(key: Key) {\n    let layoutInfo = this.getLayoutInfo(key);\n    // Refactored from v2. Current strategy is to find the closest card in the adjacent column.\n    // This prevent the issue where it was possible that the closest layoutInfo would be two columns over due to the middle card being exceptionally tall\n    // and thus the top corner to top corner distance was massive.\n\n    // First look for a card to the immediate right of the current card. If we can't find any, look for the nearest card in the entire column to the right of the card\n    let rect = new Rect(layoutInfo.rect.maxX + 1, layoutInfo.rect.y, layoutInfo.rect.width + this.horizontalSpacing, layoutInfo.rect.height);\n    key = this._findClosest(layoutInfo.rect, rect)?.key;\n\n    if (!key) {\n      rect = new Rect(layoutInfo.rect.maxX + 1, 0, layoutInfo.rect.width + this.horizontalSpacing, this.virtualizer.contentSize.height);\n      key = this._findClosest(layoutInfo.rect, rect)?.key;\n    }\n\n    let item = this.collection.getItem(key);\n    return getFirstItem(getChildNodes(item, this.collection))?.key;\n  }\n\n  getClosestLeft(key: Key) {\n    let layoutInfo = this.getLayoutInfo(key);\n     // First look for a card to the immediate left of the current card. If we can't find any, look for the nearest card in the entire column to the left of the card\n    let rect = new Rect(layoutInfo.rect.x - layoutInfo.rect.width - this.horizontalSpacing - 1, layoutInfo.rect.y, layoutInfo.rect.width + this.horizontalSpacing, layoutInfo.rect.height);\n    key = this._findClosest(layoutInfo.rect, rect)?.key;\n\n    if (!key) {\n      rect = new Rect(layoutInfo.rect.x - layoutInfo.rect.width - this.horizontalSpacing - 1, 0, layoutInfo.rect.width + this.horizontalSpacing, this.virtualizer.contentSize.height);\n      key = this._findClosest(layoutInfo.rect, rect)?.key;\n    }\n\n    let item = this.collection.getItem(key);\n    return getFirstItem(getChildNodes(item, this.collection))?.key;\n  }\n\n  getKeyRightOf(key: Key) {\n    // Expected key is the currently focused cell so we need the parent row key\n    let parentRowKey = this.collection.getItem(key).parentKey;\n    return this.direction === 'rtl' ?  this.getClosestLeft(parentRowKey) : this.getClosestRight(parentRowKey);\n  }\n\n  getKeyLeftOf(key: Key) {\n    // Expected key is the currently focused cell so we need the parent row key\n    let parentRowKey = this.collection.getItem(key).parentKey;\n    return this.direction === 'rtl' ?  this.getClosestRight(parentRowKey) : this.getClosestLeft(parentRowKey);\n  }\n}\n","/*\n * Copyright 2021 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport {CardBase} from './CardBase';\nimport {DOMRef, DOMRefValue, ItemProps} from '@react-types/shared';\nimport {PartialNode} from '@react-stately/collections';\nimport React, {forwardRef, ForwardRefExoticComponent, PropsWithoutRef, RefAttributes} from 'react';\nimport {SpectrumCardProps} from '@react-types/card';\nimport {useCardViewContext} from './CardViewContext';\n\n\nlet Card = forwardRef((props: SpectrumCardProps, ref: DOMRef<HTMLDivElement>) => {\n  let context = useCardViewContext();\n  if (context !== null) {\n    return null;\n  } else {\n    return (\n      <CardBase {...props} ref={ref} />\n    );\n  }\n});\n\n// @ts-ignore\nCard.getCollectionNode = function* getCollectionNode<T>(props: any): Generator<PartialNode<T>> {\n  let {children, textValue} = props;\n\n  yield {\n    type: 'item',\n    props: props,\n    rendered: children,\n    'aria-label': props['aria-label'],\n    hasChildNodes: false,\n    textValue\n  };\n};\n\nlet _Card = Card as ForwardRefExoticComponent<ItemProps<SpectrumCardProps> & PropsWithoutRef<SpectrumCardProps> & RefAttributes<DOMRefValue<HTMLDivElement>>>;\nexport {_Card as Card};\n"],"names":[],"version":3,"file":"module.js.map"}